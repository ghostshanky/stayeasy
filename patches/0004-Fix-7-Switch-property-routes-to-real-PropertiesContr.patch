From 07d041d276ac98e76e59ba038a36e03f9ba2ae86 Mon Sep 17 00:00:00 2001
From: ghostshanky <actofjoy00@gmail.com>
Date: Mon, 1 Dec 2025 13:09:32 +0530
Subject: [PATCH 04/19] Fix #7: Switch property routes to real
 PropertiesController

- Replaced MockPropertiesController with PropertiesController in routes
- Owner routes now use database-backed property creation
- Tenant routes also updated for consistency
- POST /api/owner/properties now works correctly
- Fixes 'Failed to become a host' error
---
 server/routes/properties.ts | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

diff --git a/server/routes/properties.ts b/server/routes/properties.ts
index 0d4221f..5992a56 100644
--- a/server/routes/properties.ts
+++ b/server/routes/properties.ts
@@ -1,6 +1,6 @@
 import express from 'express'
 import { requireAuth, requireRole } from '../middleware.js'
-import { MockPropertiesController } from '../controllers/mockPropertiesController.js'
+import { PropertiesController } from '../controllers/propertiesController.js'
 import rateLimit from 'express-rate-limit'
 
 const propertiesRoutes = express.Router()
@@ -14,13 +14,13 @@ const propertyLimiter = rateLimit({
   message: { success: false, error: { code: 'TOO_MANY_REQUESTS', message: 'Too many requests, please try again later.' } }
 })
 
-// Owner routes
+// Owner routes - using real PropertiesController with Supabase data
 propertiesRoutes.post(
   '/owner/properties',
   propertyLimiter,
   requireAuth,
   requireRole(['OWNER']),
-  MockPropertiesController.createProperty
+  PropertiesController.createProperty
 )
 
 propertiesRoutes.put(
@@ -28,7 +28,7 @@ propertiesRoutes.put(
   propertyLimiter,
   requireAuth,
   requireRole(['OWNER']),
-  MockPropertiesController.updateProperty
+  PropertiesController.updateProperty
 )
 
 propertiesRoutes.delete(
@@ -36,29 +36,29 @@ propertiesRoutes.delete(
   propertyLimiter,
   requireAuth,
   requireRole(['OWNER']),
-  MockPropertiesController.deleteProperty
+  PropertiesController.deleteProperty
 )
 
 propertiesRoutes.get(
   '/owner/properties',
   requireAuth,
   requireRole(['OWNER']),
-  MockPropertiesController.getOwnerProperties
+  PropertiesController.getOwnerProperties
 )
 
-// Tenant routes
+// Tenant routes - using real PropertiesController
 propertiesRoutes.get(
   '/tenant/properties',
   requireAuth,
   requireRole(['TENANT']),
-  MockPropertiesController.getProperties
+  PropertiesController.getProperties
 )
 
 propertiesRoutes.get(
   '/tenant/properties/:id',
   requireAuth,
   requireRole(['TENANT']),
-  MockPropertiesController.getPropertyDetails
+  PropertiesController.getPropertyDetails
 )
 
 // Welcome endpoint for properties API
-- 
2.51.0.windows.1

